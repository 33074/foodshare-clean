databases:
  - name: foodshare-mysql
    databaseName: foodshare_db
    user: foodshare_user
    plan: free

services:
  - type: web
    name: foodshare-backend
    runtime: docker
    repo: https://github.com/33074/foodshare-clean.git
    branch: main
    dockerContext: ./foodshare-backend
    dockerfilePath: ./foodshare-backend/Dockerfile
    plan: free
    healthCheckPath: /actuator/health
    envVars:
      - key: SPRING_DATASOURCE_URL
        value: jdbc:mysql://${foodshare-mysql.host}:${foodshare-mysql.port}/${foodshare-mysql.database}?useSSL=false&allowPublicKeyRetrieval=true
      - key: SPRING_DATASOURCE_USERNAME
        fromDatabase:
          name: foodshare-mysql
          property: user
      - key: SPRING_DATASOURCE_PASSWORD
        fromDatabase:
          name: foodshare-mysql
          property: password
      
      - key: JWT_SECRET_KEY
        sync: false # Set in Render dashboard

      # --- THIS IS THE FIX ---
      # We removed the hardcoded password and will set it in Render
      - key: SPRING_MAIL_HOST
        value: smtp-relay.brevo.com
      - key: SPRING_MAIL_PORT
        value: 587
      - key: SPRING_MAIL_USERNAME
        value: 9a20a6001@smtp-brevo.com
      - key: SPRING_MAIL_PASSWORD
        sync: false # Set this value manually in the Render dashboard
      - key: SPRING_MAIL_FROM
        value: 2300033074cseh2@gmail.com
      # --- END FIX ---

      - key: GOOGLE_CLIENT_ID
        sync: false # Set in Render dashboard
      - key: GOOGLE_CLIENT_SECRET
        sync: false # Set in Render dashboard
